<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Piotr Klibert" />
    <meta name="description" content="Exciting new programming Languages and Polyglot programming; also Emacs" />

    <link rel="preload" as="font" href="/statics/fonts/Roboto-Regular.ttf" type="font/ttf" crossorigin="anonymous" />
    <link rel="preload" as="font" href="/statics/fonts/Roboto-Italic.ttf" type="font/ttf" crossorigin="anonymous" />
    <link rel="preload" as="font" href="/statics/fonts/Roboto-Black.ttf" type="font/ttf" crossorigin="anonymous" />
    <link rel="preload" as="font" href="/statics/fonts/Roboto-Black.ttf" type="font/ttf" crossorigin="anonymous" />
    <link rel="preload" href="/output/base.min.css?cache_busting_cookie=4333" as="style" />

    <link rel="icon" type="image/x-icon" href="/statics/images/favicon.ico" />
    <link href="/statics/base.min.css?cache_busting_cookie=4287" rel="stylesheet" />
    <link href="/statics/styles/my-styles.css?cache_busting_cookie=4202" rel="stylesheet" />
    <link href="/statics/highlight-code.min.css?cache_busting_cookie=4398" rel="stylesheet" />
    <style type="text/css">.example { color: white; }</style>
    <title>Advent of Code 2023 - Day 3, Part 1 -- Piotr Klibert's blog</title>
  </head>
  <body>

    <header id="blog-header">
      <div id="blog-title">
        <h1>The Right Lang for the Job</h1>
        <div><p>Exploring the abbyss of non-mainstream programming languages</p></div>
      </div>

      <div id="top-menu-container">
        <nav>
          <a href="/">Blog</a>
          <!-- <a href="/articles/archive.html">Archive</a> -->
          <!-- <a href="/articles/programming_langs.html">Languages</a> -->
          <!-- <a href="/articles/about.html">About</a> -->
          <!-- <a href="/articles/contact.html">Contact</a> -->
          <!-- <div id="blog-nav-rss"> -->
          <!-- <a nofolow="1" href="/statics/feed.xml"> -->
          <!-- <img src="/statics/icons/rss0.png" alt="RSS icon" /> -->
          <!-- </a> -->
          <!-- </div> -->
        </nav>
      </div>
    </header>

    <main id="blog-main">
      <div class="blog-main">
        
  <article>
    <header>
      <h1 class="entry-title">
        <a class="title-link" id="advent-of-code-2023-day-3-part-1" href="/posts/advent-of-code-2023-day-3-part-1.html" title="Read on separate page">
          Advent of Code 2023 - Day 3, Part 1
        </a>
        <a href="#advent-of-code-2023-day-3-part-1" class="robaczek" title="Link to this place on current page">Â¶</a>
      </h1>
      
        <h3 class="subtitle">A classic, buffer-based implementation this time</h3>
      
      <p class="meta">
        Created: <time>&lt;2023-12-03 10:04:36&gt;</time>
        
      </p>
    </header>

    <p>
I made it! I woke up early, drank 3 coffees, but in the end, I managed to solve
the puzzle and post the solution before <a href="https://code.tvl.fyi/tree/users/tazjin/aoc2023">the</a> <a href="https://github.com/amno1/AOC2023/tree/main">others</a>! ðŸ™‚
</p>

<p>
<a href="https://adventofcode.com/2023/day/3">The puzzle</a> this time is about extracting numbers from a 2D array of characters
and checking whether the number neighbours any character other than a dot (".").
</p>

<p>
In Emacs, all text is in a 2D array by default - that's (conceptually) what a
buffer is, after all. So there's really not much to the solution this time,
other than handling some corner cases (first and last lines, and treating
newlines as dots - for numbers that are at the end of the line).
</p>

<p>
Here's the solution:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="linenr"> 1: </span><span style="color: #99968b;">;; </span><span style="color: #00ffff; background-color: #8b7e66; font-weight: bold;">NOTE</span><span style="color: #99968b;">: lines are 140 characters wide (maybe verify this instead of assuming?)</span>
<span class="linenr"> 2: </span><span style="color: #5f9ea0;">(</span><span style="color: #8ac6f2; font-weight: bold;">with-current-buffer</span> <span style="color: #ff66ff;">(</span>get-buffer <span style="color: #95e454;">"input3.txt"</span><span style="color: #ff66ff;">)</span>
<span class="linenr"> 3: </span>  <span style="color: #ff66ff;">(</span>goto-char <span style="color: #00eff0;">(</span>point-min<span style="color: #00eff0;">)</span><span style="color: #ff66ff;">)</span>
<span class="linenr"> 4: </span>  <span style="color: #ff66ff;">(</span><span style="color: #8ac6f2; font-weight: bold;">let</span> <span style="color: #00eff0;">(</span><span style="color: #cae682;">numbers</span> <span style="color: #ff6b55;">(</span><span style="color: #cae682;">lines</span> <span style="color: #efef00;">(</span>count-lines <span style="color: #b6a0ff;">(</span>point-min<span style="color: #b6a0ff;">)</span> <span style="color: #b6a0ff;">(</span>point-max<span style="color: #b6a0ff;">)</span><span style="color: #efef00;">)</span><span style="color: #ff6b55;">)</span><span style="color: #00eff0;">)</span>
<span class="linenr"> 5: </span>    <span style="color: #00eff0;">(</span><span style="color: #8ac6f2; font-weight: bold;">while</span> <span style="color: #ff6b55;">(</span>re-search-forward <span style="color: #efef00;">(</span><span style="color: #8ac6f2; font-weight: bold;">rx</span> <span style="color: #b6a0ff;">(</span>1+ num<span style="color: #b6a0ff;">)</span><span style="color: #efef00;">)</span> nil t<span style="color: #ff6b55;">)</span>
<span class="linenr"> 6: </span>      <span style="color: #ff6b55;">(</span><span style="color: #8ac6f2; font-weight: bold;">let*</span> <span style="color: #efef00;">(</span><span style="color: #b6a0ff;">(</span><span style="color: #cae682;">beg</span> <span style="color: #5f9ea0;">(</span>match-beginning 0<span style="color: #5f9ea0;">)</span><span style="color: #b6a0ff;">)</span>
<span class="linenr"> 7: </span>             <span style="color: #b6a0ff;">(</span><span style="color: #cae682;">end</span> <span style="color: #5f9ea0;">(</span>match-end 0<span style="color: #5f9ea0;">)</span><span style="color: #b6a0ff;">)</span>
<span class="linenr"> 8: </span>             <span style="color: #b6a0ff;">(</span><span style="color: #cae682;">surrounding</span> <span style="color: #5f9ea0;">(</span>concat 
<span class="linenr"> 9: </span>                           <span style="color: #79a8ff;">(</span>string <span style="color: #f78fe7;">(</span>char-after <span style="color: #5f9ea0;">(</span>1- beg<span style="color: #5f9ea0;">)</span><span style="color: #f78fe7;">)</span><span style="color: #79a8ff;">)</span> <span style="color: #99968b;">; </span><span style="color: #99968b;">preceding char</span>
<span class="linenr">10: </span>                           <span style="color: #79a8ff;">(</span>string <span style="color: #f78fe7;">(</span>char-after end<span style="color: #f78fe7;">)</span><span style="color: #79a8ff;">)</span>      <span style="color: #99968b;">; </span><span style="color: #99968b;">following char</span>
<span class="linenr">11: </span>                           <span style="color: #99968b;">;; </span><span style="color: #99968b;">previous line</span>
<span class="linenr">12: </span>                           <span style="color: #79a8ff;">(</span><span style="color: #8ac6f2; font-weight: bold;">if</span> <span style="color: #f78fe7;">(</span>not <span style="color: #5f9ea0;">(</span>= 1 <span style="color: #ff66ff;">(</span>line-number-at-pos<span style="color: #ff66ff;">)</span><span style="color: #5f9ea0;">)</span><span style="color: #f78fe7;">)</span>
<span class="linenr">13: </span>                               <span style="color: #f78fe7;">(</span>buffer-substring-no-properties <span style="color: #5f9ea0;">(</span>- beg 142<span style="color: #5f9ea0;">)</span> <span style="color: #5f9ea0;">(</span>- end 140<span style="color: #5f9ea0;">)</span><span style="color: #f78fe7;">)</span>
<span class="linenr">14: </span>                             <span style="color: #95e454;">"."</span><span style="color: #79a8ff;">)</span>
<span class="linenr">15: </span>                           <span style="color: #99968b;">;; </span><span style="color: #99968b;">next line</span>
<span class="linenr">16: </span>                           <span style="color: #79a8ff;">(</span><span style="color: #8ac6f2; font-weight: bold;">if</span> <span style="color: #f78fe7;">(</span>not <span style="color: #5f9ea0;">(</span>= lines <span style="color: #ff66ff;">(</span>line-number-at-pos<span style="color: #ff66ff;">)</span><span style="color: #5f9ea0;">)</span><span style="color: #f78fe7;">)</span>
<span class="linenr">17: </span>                               <span style="color: #f78fe7;">(</span>buffer-substring-no-properties <span style="color: #5f9ea0;">(</span>+ beg 140<span style="color: #5f9ea0;">)</span> <span style="color: #5f9ea0;">(</span>+ end 142<span style="color: #5f9ea0;">)</span><span style="color: #f78fe7;">)</span>
<span class="linenr">18: </span>                             <span style="color: #95e454;">"."</span><span style="color: #79a8ff;">)</span><span style="color: #5f9ea0;">)</span><span style="color: #b6a0ff;">)</span><span style="color: #efef00;">)</span>
<span class="linenr">19: </span>        <span style="color: #efef00;">(</span><span style="color: #8ac6f2; font-weight: bold;">unless</span> <span style="color: #b6a0ff;">(</span>cl-every <span style="color: #5f9ea0;">(</span><span style="color: #8ac6f2; font-weight: bold;">lambda</span> <span style="color: #79a8ff;">(</span><span style="color: #cae682;">c</span><span style="color: #79a8ff;">)</span> <span style="color: #79a8ff;">(</span><span style="color: #8ac6f2; font-weight: bold;">or</span> <span style="color: #f78fe7;">(</span>eq c ?\n<span style="color: #f78fe7;">)</span> <span style="color: #f78fe7;">(</span>eq c ?.<span style="color: #f78fe7;">)</span><span style="color: #79a8ff;">)</span><span style="color: #5f9ea0;">)</span> surrounding<span style="color: #b6a0ff;">)</span>
<span class="linenr">20: </span>          <span style="color: #b6a0ff;">(</span><span style="color: #8ac6f2; font-weight: bold;">push</span> <span style="color: #5f9ea0;">(</span>string-to-number <span style="color: #79a8ff;">(</span>match-string 0<span style="color: #79a8ff;">)</span><span style="color: #5f9ea0;">)</span> numbers<span style="color: #b6a0ff;">)</span><span style="color: #efef00;">)</span><span style="color: #ff6b55;">)</span><span style="color: #00eff0;">)</span>
<span class="linenr">21: </span>    <span style="color: #00eff0;">(</span>apply #'<span style="color: #cae682;">+</span> numbers<span style="color: #00eff0;">)</span><span style="color: #ff66ff;">)</span><span style="color: #5f9ea0;">)</span>
</pre>
</div>

<pre class="example">
507214
</pre>


<p>
We just loop through the numbers in the buffer, fetch the characters that
surround the number, and verify there are only dots (and newlines, as a special
case) in these characters.
</p>

<p>
I thought about using <code>save-excursion</code> and <code>forward-line</code> to get the preceding
and following lines, then using <code>looking-at-p</code> to check for symbols - I think it
would work and I wouldn't need to check line width in that case. By the time I
thought of it, though, <code>buffer-substring</code>-based solution worked already, so I
just left it as is.
</p>

<p>
Unfortunately, I don't have the time to solve Part 2 of the puzzle. In part 2,
you need to find all <code>*</code> symbols that have more than one number in its
surroundings. It's more interesting than Part 1 because there are more ways of
solving it. I'll see if I have the time to code the solution in the evening.
</p>

  </article>

      </div>

      <div class="blog-sidebar">

        <div class="sidebar-module sidebar-module-inset">
          You can now subscribe to an
          <a nofolow="1" href="/statics/feed.xml">RSS feed</a>
          <a nofolow="1" href="/statics/feed.xml"><img src="/statics/feed-icon-14x14.png" style="vertical-align: baseline;"/></a>.
        </div>

        <!-- <div class="sidebar-module sidebar-module-inset" id="posts-module"> -->
        <!-- <h4 style="">Latest posts</h4> -->
        <!-- <ol class="list-unstyled posts-links"></ol> -->
        <!-- </div> -->
        <div class="quote-of-the-year sidebar-module sidebar-module-inset">
          <h4 style="text-align: center">Quote of the Year 2023</h4>
          <blockquote>
            One of the most surprising things I've witnessed in my lifetime is
            the rebirth of the concept of heresy.
            <footer>â€” <cite><a href="http://paulgraham.com/heresy.html">Paul Graham</a></cite></footer>
          </blockquote>
        </div>

        <div class="sidebar-module sidebar-module-inset">
          <h4>About me</h4>
          <p>
            I'm a programmer. I like learning programming languages. I've been
            doing it for more than a decade.
          </p>
          <p>
            Here's roughly <a href="/articles/about.html#history">what I learned</a>
            to date.
          </p>
          <p>
            <a href="/articles/contact.html">Contact me</a>
          </p>
        </div>

        <div class="sidebar-module sidebar-module-inset" id="links-module">
          <h4>Links</h4>

          <ol class="links-list">
            <li><a href="https://www.youtube.com/watch?v=m09RWtt5nd8">Video of my talk on FP</a></li>
            <li><a href="/warsawjs-talk/">Slides</a> and <a href="/warsawjs-talk/code.html">Examples</a> for the talk</li>
          </ol>

          <ol class="links-list">
            <li><a href="http://hashrocket.com/blog/posts/taking-advantage-of-the-polyglot-lifestyle">Polyglot Lifestyle</a></li>
            <li><a href="https://hyperpolyglot.org/">HyperPolyglot - language comparisons</a></li>
            <li><a href="https://programming-idioms.org/">Programming Idioms</a></li>
            <li><a href="https://github.com/kanaka/mal/blob/master/process/guide.md">Make a Lisp</a></li>
            <li><a href="http://rosettacode.org/wiki/Rosetta_Code">Rosetta Code</a></li>
            <li><a href="http://pleac.sourceforge.net/">PLEAC - Programming Language Examples Alike Cookbook</a></li>
            <li><a href="http://learnxinyminutes.com/">Learn X in Y Minutes</a></li>
            <li><a href="http://hyperpolyglot.org/">Hyperpolyglot</a></li>
            <li><a href="http://rigaux.org/language-study/syntax-across-languages/">PL syntaxes comparison</a></li>
            <li><a href="https://github.com/kanaka/mal">Make a Lisp</a></li>
            <li><a href="https://modern-sql.com/use-case/literate-sql">Literate SQL</a></li>
            <li><a href="http://en.literateprograms.org/LiteratePrograms:Welcome">Literate Programs</a></li>
            <li><a href="http://radar.oreilly.com/2013/11/polyglot-programming-what-is-it-and-why-should-you-be-using-it.html">Why Polyglot?</a></li>
          </ol>
        </div>

        <div class="quote-of-the-year sidebar-module sidebar-module-inset">
          <h4 style="text-align: center">Quote of the Year 2022</h4>
          <blockquote>
            It's amazing what you can talk yourself into liking
            <footer>â€” <cite>Steve Yegge</cite></footer>
          </blockquote>
        </div>


        <div class="quote-of-the-year sidebar-module sidebar-module-inset">
          <h4 style="text-align: center">Quote of the Year 2020</h4>
          <blockquote>
            What can change the nature of a man?
            <footer>â€” <cite>Ravel Puzzlewell</cite></footer>
          </blockquote>
        </div>

        <div class="quote-of-the-year sidebar-module sidebar-module-inset">
          <h4 style="text-align: center">Quote of the Year 2017</h4>
          <blockquote>
            One foot in the grave, the other in Hell.
            <footer>â€” <cite>The Nameless One</cite></footer>
          </blockquote>
        </div>

        <div class="quote-of-the-year sidebar-module sidebar-module-inset">
          <h4 style="text-align: center">Catch phrase of the Year 2016</h4>
          <blockquote>
            It isn't ideal that...
            <footer>â€” <cite>many different people</cite></footer>
          </blockquote>
        </div>

        <div class="quote-of-the-year sidebar-module sidebar-module-inset">
          <h4 style="text-align: center">Quote of the Year 2015</h4>
          <blockquote>
            You can't type-check being hit by a lightning, can you?
            <footer>
              â€” <cite>Joe Armstrong, creator of <a href="https://en.wikipedia.org/wiki/Erlang_(programming_language)">Erlang</a></cite>
            </footer>
          </blockquote>
        </div>

        <div class="quote-of-the-year sidebar-module sidebar-module-inset">
          <h4 style="text-align: center">Quote of the Year 2014</h4>
          <blockquote>
            But you <i>do know</i> that non-programmers are
            people, too?
            <footer>â€” <cite>MichaÅ‚ KÅ‚ujszo</cite></footer>
          </blockquote>
        </div>
      </div> <!-- /.blog-sidebar -->
    </main>
    <footer class="blog-footer">
      <p><a href="#">Back to top</a> / <a href="">More posts</a> </p>
    </footer>

    <script src="/statics/bundle.js?cache_busting_cookie=4239"></script>
  </body>
</html>
